async io io PrintWriter io concurrent CountDownLatch concurrent TimeUnit concurrent TimeoutException concurrent atomic AtomicBoolean junit framework TestCase TException protocol TBinaryProtocol server ServerTestBase server THsHaServer server THsHaServer Args transport TNonblockingServerSocket transport TNonblockingSocket test CompactProtoTestStruct test Srv test Srv Iface test Srv AsyncClient Janky_call test Srv AsyncClient onewayMethod_call test Srv AsyncClient primitiveMethod_call test Srv AsyncClient voidMethod_call testtasyncclientmanager testcase thshaserver server_ serverthread_ tasyncclientmanager clientmanager_ setup server_ thshaserver args tnonblockingserversocket servertestbase.port processor srv.processor srvhandler serverthread_ run server_.serve serverthread_.start clientmanager_ tasyncclientmanager thread.sleep teardown server_.stop clientmanager_.stop serverthread_.join testbasiccall srv.asyncclient client getclient basiccall client testbasiccallwithtimeout srv.asyncclient client getclient client.settimeout basiccall client testtimeoutcall countdownlatch latch countdownlatch srv.asyncclient client getclient client.settimeout client.primitivemethod asyncmethodcallback primitivemethod_call override exception exception timeoutexception sink exception.printstacktrace printwriter sink fail sink.tostring latch.countdown override oncomplete primitivemethod_call response fail latch.countdown latch.await timeunit.seconds asserttrue client.haserror asserttrue client.geterror timeoutexception testvoidcall countdownlatch latch countdownlatch atomicboolean returned atomicboolean srv.asyncclient client getclient client.voidmethod failurelesscallback srv.asyncclient.voidmethod_call override oncomplete voidmethod_call response response.getresult returned.set texception fail latch.countdown latch.await timeunit.seconds asserttrue returned.get testonewaycall countdownlatch latch countdownlatch atomicboolean returned atomicboolean srv.asyncclient client getclient client.onewaymethod failurelesscallback onewaymethod_call override oncomplete onewaymethod_call response response.getresult returned.set texception fail latch.countdown latch.await timeunit.seconds asserttrue returned.get testparallelcalls numthreads numcallsperthread jankyrunnable runnables jankyrunnable threads numthreads jankyrunnable runnable jankyrunnable numcallsperthread thread runnable thread.start threads.add thread runnables.add runnable thread threads thread.join numsuccesses jankyrunnable runnable runnables numsuccesses runnable.getnumsuccesses assertequals numthreads numcallsperthread numsuccesses srv.asyncclient getclient tnonblockingsocket clientsocket tnonblockingsocket servertestbase.host servertestbase.port srv.asyncclient tbinaryprotocol.factory clientmanager_ clientsocket basiccall srv.asyncclient client countdownlatch latch countdownlatch atomicboolean returned atomicboolean client.janky failurelesscallback srv.asyncclient.janky_call override oncomplete janky_call response assertequals response.getresult returned.set texception fail latch.countdown override exception sink exception.printstacktrace printwriter sink fail sink.tostring latch.countdown latch.await timeunit.seconds asserttrue returned.get srvhandler iface override janky arg texception assertequals arg override primitivemethod texception thread.sleep interruptedexception e.printstacktrace override methodwithdefaultargs texception override compactprototeststruct structmethod texception override texception override onewaymethod texception failurelesscallback t tasyncmethodcall asyncmethodcallback t override exception fail exception fail exception sink exception.printstacktrace printwriter sink fail sink.tostring jankyrunnable numcalls_ numsuccesses_ srv.asyncclient client_ jankyrunnable numcalls numcalls_ numcalls client_ getclient client_.settimeout getnumsuccesses numsuccesses_ run numcalls_ client_.haserror iteration countdownlatch latch countdownlatch atomicboolean returned atomicboolean client_.janky asyncmethodcallback srv.asyncclient.janky_call override oncomplete janky_call response assertequals response.getresult returned.set latch.countdown texception latch.countdown fail override exception sink exception.printstacktrace printwriter sink fail iteration sink.tostring latch.countdown calledback latch.await timeunit.seconds asserttrue iteration calledback asserttrue iteration returned.get this.numsuccesses_ fail 